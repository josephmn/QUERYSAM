
sp_helptext  IncentivoSemanal

select * from IncentivoSemanal order by semana,cod,opcion asc

 alter view IncentivoSemanal  
 as  
 select 32 semana , 100  cod, 1 opcion union all   
 select 33 semana , 100  cod, 1 opcion union all   
 select 34 semana , 100  cod, 1 opcion union all   
 select 35 semana , 100  cod, 1 opcion union all   
 select 36 semana , 100  cod, 2 opcion union all   
 select 37 semana , 100  cod, 3 opcion union all   
 select 38 semana , 100  cod, 3 opcion union all   
 select 39 semana , 100  cod, 3 opcion union all   
 select 32 semana , 101  cod, 1 opcion union all   
 select 33 semana , 101  cod, 1 opcion union all   
 select 34 semana , 101  cod, 1 opcion union all   
 select 35 semana , 101  cod, 1 opcion union all   
 select 36 semana , 101  cod, 2 opcion union all   
 select 37 semana , 101  cod, 3 opcion union all   
 select 38 semana , 101  cod, 3 opcion union all   
 select 39 semana , 101  cod, 3 opcion union all   
 select 32 semana , 102  cod, 1 opcion union all   
 select 33 semana , 102  cod, 1 opcion union all   
 select 34 semana , 102  cod, 1 opcion union all   
 select 35 semana , 102  cod, 1 opcion union all   
 select 36 semana , 102  cod, 2 opcion union all   
 select 37 semana , 102  cod, 3 opcion union all   
 select 38 semana , 102  cod, 3 opcion union all   
 select 39 semana , 102  cod, 3 opcion union all   
 select 32 semana , 103  cod, 1 opcion union all   
 select 33 semana , 103  cod, 1 opcion union all   
 select 34 semana , 103  cod, 1 opcion union all   
 select 35 semana , 103  cod, 1 opcion union all   
 select 36 semana , 103  cod, 2 opcion union all   
 select 37 semana , 103  cod, 3 opcion union all   
 select 38 semana , 103  cod, 3 opcion union all   
 select 39 semana , 103  cod, 3 opcion union all   
 select 32 semana , 104  cod, 1 opcion union all   
 select 33 semana , 104  cod, 1 opcion union all   
 select 34 semana , 104  cod, 1 opcion union all   
 select 35 semana , 104  cod, 1 opcion union all   
 select 36 semana , 104  cod, 2 opcion union all   
 select 37 semana , 104  cod, 3 opcion union all   
 select 38 semana , 104  cod, 3 opcion union all   
 select 39 semana , 104  cod, 3 opcion union all   
 select 32 semana , 105  cod, 1 opcion union all   
 select 33 semana , 105  cod, 1 opcion union all   
 select 34 semana , 105  cod, 1 opcion union all   
 select 35 semana , 105  cod, 1 opcion union all   
 select 36 semana , 105  cod, 2 opcion union all   
 select 37 semana , 105  cod, 3 opcion union all   
 select 38 semana , 105  cod, 3 opcion union all   
 select 39 semana , 105  cod, 3 opcion union all     
 select 40 semana , 100  cod, 3 opcion union all   
 select 40 semana , 101  cod, 3 opcion union all   
 select 40 semana , 102  cod, 3 opcion union all   
 select 40 semana , 103  cod, 3 opcion union all   
 select 40 semana , 104  cod, 3 opcion union all   
 select 40 semana , 105  cod, 3 opcion union all
 -- 
 select 41 semana , 100  cod, 3 opcion union all   
 select 41 semana , 101  cod, 3 opcion union all   
 select 41 semana , 102  cod, 3 opcion union all   
 select 41 semana , 103  cod, 3 opcion union all   
 select 41 semana , 104  cod, 3 opcion union all   
 select 41 semana , 105  cod, 3 opcion union all
 --
 select 42 semana , 100  cod, 3 opcion union all   
 select 42 semana , 101  cod, 3 opcion union all   
 select 42 semana , 102  cod, 3 opcion union all   
 select 42 semana , 103  cod, 3 opcion union all   
 select 42 semana , 104  cod, 3 opcion union all   
 select 42 semana , 105  cod, 3 opcion union all
 --
 select 43 semana , 100  cod, 3 opcion union all   
 select 43 semana , 101  cod, 3 opcion union all   
 select 43 semana , 102  cod, 3 opcion union all   
 select 43 semana , 103  cod, 3 opcion union all   
 select 43 semana , 104  cod, 3 opcion union all   
 select 43 semana , 105  cod, 3 opcion union all
 --
 select 44 semana , 100  cod, 3 opcion union all   
 select 44 semana , 101  cod, 3 opcion union all   
 select 44 semana , 102  cod, 3 opcion union all   
 select 44 semana , 103  cod, 3 opcion union all   
 select 44 semana , 104  cod, 3 opcion union all   
 select 44 semana , 105  cod, 3 opcion union all
 --
 select 45 semana , 100  cod, 3 opcion union all   
 select 45 semana , 101  cod, 3 opcion union all   
 select 45 semana , 102  cod, 3 opcion union all   
 select 45 semana , 103  cod, 3 opcion union all   
 select 45 semana , 104  cod, 3 opcion union all   
 select 45 semana , 105  cod, 3 opcion union all
 --
 select 46 semana , 100  cod, 3 opcion union all   
 select 46 semana , 101  cod, 3 opcion union all   
 select 46 semana , 102  cod, 3 opcion union all   
 select 46 semana , 103  cod, 3 opcion union all   
 select 46 semana , 104  cod, 3 opcion union all   
 select 46 semana , 105  cod, 3 opcion union all
 --
 select 47 semana , 100  cod, 3 opcion union all   
 select 47 semana , 101  cod, 3 opcion union all   
 select 47 semana , 102  cod, 3 opcion union all   
 select 47 semana , 103  cod, 3 opcion union all   
 select 47 semana , 104  cod, 3 opcion union all   
 select 47 semana , 105  cod, 3 opcion union all
 --
  select 48 semana , 100  cod, 3 opcion union all   
 select 48 semana , 101  cod, 3 opcion union all   
 select 48 semana , 102  cod, 3 opcion union all   
 select 48 semana , 103  cod, 3 opcion union all   
 select 48 semana , 104  cod, 3 opcion union all   
 select 48 semana , 105  cod, 3 opcion union all
 --
  select 49 semana , 100  cod, 3 opcion union all   
 select 49 semana , 101  cod, 3 opcion union all   
 select 49 semana , 102  cod, 3 opcion union all   
 select 49 semana , 103  cod, 3 opcion union all   
 select 49 semana , 104  cod, 3 opcion union all   
 select 49 semana , 105  cod, 3 opcion union all
 --
  select 50 semana , 100  cod, 3 opcion union all   
 select 50 semana , 101  cod, 3 opcion union all   
 select 50 semana , 102  cod, 3 opcion union all   
 select 50 semana , 103  cod, 3 opcion union all   
 select 50 semana , 104  cod, 3 opcion union all   
 select 50 semana , 105  cod, 3 opcion 
 
 
 
 
 
 
 select * from rpt_inct_cobranza
 
 
 sp_helptext  rpt_inct_cobranza
 
 CREATE view rpt_inct_cobranza    
as    
select periodoPago ,Periodo ,supervisor,s.name,round(convert(decimal,cuota),2)cuota,round(convert(decimal,cobrado),2)cobrado,  
round(convert(decimal,avance),0)avance,isnull((select max(cobr) from NuevosIncentivos where  periodo= C.periodo and tipo = 10   
 and SubTipo = 1  and porc <= round(avance,0)),0) InctCobranza    
from vs_avanceCobranza C inner join salesperson S on C.supervisor = S.slsperid 
 
 
 sp_helptext  NuevosIncentivos
 
 alter view NuevosIncentivos        
as        
-- val1 altomayo      
-- val2 montealto      
-- val3 kimbo      
select '201601' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo      
union all      
select '201602' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo      
union all      
select '201603' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo      
      
union all      
select '201604' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo      
union all      
select '201605' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo      
union all      
select '201606' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo_BONO      
union all      
select '201607' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo_BONO      
union all      
select '201608' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo_BONO      
union all       
select '201609' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo_BONO   
union all       
select '201610' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo_BONO 
union all
select '201611' periodo,tipo,subTipo,porc,val1,val2,val3,COBR,BONO,user1,user2 from NuevosIncentivos_Periodo_BONO 