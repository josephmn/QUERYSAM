
/**** REFERENCIA PASOS FACTURADOR ****/ --REGRESAR PASOS ANTERIORES
select InvtID  ,NextFunctionClass,NextFunctionID ,
(CASe 

when NextFunctionClass='0100' and NextFunctionID='4043000 ' then 'En despacho' 
when NextFunctionClass='0100' and NextFunctionID='4099999 ' then 'Imprimir Factura' 
when NextFunctionClass='4060' and NextFunctionID='4068001' then 'Asignar Transportista' 
when NextFunctionClass='4060' and NextFunctionID='4068002' then 'Imprimir Vocher'
  
end ),
Cancelled ,H.Status ,SUM(QtyPick) 
from newSH H 
inner join newSL L on H.ShipperID = L.ShipperID  AND H.ShipperID = 'FLI0005076'
--where l.InvtID ='21399' and h.SiteID ='CIXPT' AND Cancelled=0
GROUP BY InvtID  ,NextFunctionClass,NextFunctionID ,Cancelled ,H.Status


--SELECT ShipperID, NextFunctionClass, NextFunctionID, * FROM newSH --WHERE SOShipperID = 'BDH0008702'

/*** REVERSION DE PASO FACTURADOR ****/

SELECT ShipperID, NextFunctionClass, NextFunctionID,* 
--BEGIN TRAN

--UPDATE X SET NextFunctionClass = '0100', NextFunctionID = '4099999'
--COMMIT
FROM newSH X WHERE ShipperID IN
(
'BDH0008713','BDH0008627','BDH0008688','BDH0008696','BDH0008712','BDH0008589','BDH0008699','BDH0008701','BDH0008709','BDH0008628','BDH0008626','BDH0008711','BDH0008698','BDH0008692','BDH0008705','BDH0008697',
'BDH0008591','BDH0008590','BDH0008625','BDH0008700','BDH0008693','BDH0008689','BDH0008690','BDH0008708','BDH0008703','BDH0008707','BDH0008656','BDH0008704','BDH0008706','BDH0008710','BDH0008702','BDH0008691',
'BDH0008695','BDH0008694','FDH0001974','FDH0001945','FDH0001975','FDH0001936','FDH0001979','FDH0001976','FDH0001978','FDH0001962','FDH0001977','FDH0001973','BDH0008680','BDH0008674','BDH0008670','BDH0008666',
'BDH0008676','BDH0008658','BDH0008672','BDH0008631','BDH0008668','BDH0008678','BDH0008669','BDH0008660','BDH0008659','BDH0008663','BDH0008665','BDH0008679','BDH0008675','BDH0008667','BDH0008681','BDH0008664',
'BDH0008662','BDH0008661','BDH0008682','BDH0008677','BDH0008673','BDH0008671','FDH0001966','FDH0001970','FDH0001971','FDH0001969','FDH0001968','FDH0001972','FDH0001967','BDH0008605','BDH0008601','BDH0008598',
'BDH0008686','BDH0008588','BDH0008630','BDH0008684','BDH0008596','BDH0008657','BDH0008606','BDH0008607','BDH0008632','BDH0008648','BDH0008592','BDH0008594','BDH0008604','BDH0008602','BDH0008600','BDH0008603',
'BDH0008595','BDH0008599','BDH0008597','BDH0008685','BDH0008624','BDH0008593','BDH0008687','BDH0008683','BDH0008633','BDH0008629','FDH0001937','FDH0001938','FDH0001953','FDH0001935','FDH0001980','FDH0001939',
'BDH0008614','BDH0008615','BDH0008655','BDH0008649','BDH0008653','BDH0008622','BDH0008612','BDH0008609','BDH0008608','BDH0008652','BDH0008650','BDH0008621','BDH0008651','BDH0008616','BDH0008620','BDH0008611',
'BDH0008613','BDH0008610','BDH0008619','BDH0008623','BDH0008654','BDH0008618','BDH0008617','FDH0001944','FDH0001961','FDH0001943','FDH0001940','FDH0001942','FDH0001941','BDH0008643','BDH0008647','BDH0008635',
'BDH0008637','BDH0008640','BDH0008641','BDH0008644','BDH0008639','BDH0008645','BDH0008642','BDH0008634','BDH0008646','BDH0008638','BDH0008636','FDH0001960','FDH0001958','FDH0001950','FDH0001964','FDH0001955',
'FDH0001957','FDH0001954','FDH0001949','FDH0001956','FDH0001951','FDH0001952','FDH0001959','FDH0001965','FDH0001963'
)