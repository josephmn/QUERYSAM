
--SELECT * FROM PERSONALBD WHERE PERID = '72130767'
--SELECT * FROM PERSONALBD WHERE PERID = '10549346'

SELECT 'OFI000000000001' CORRELATIVO, A.EMPRESA, A.PER_COD, L.LOC_ID, L.LOC_NOM, L.ABREV, G.HoraInicio, G.HoraFin, G.Tolerancia, G.HISegundos, G.HFSalida
FROM PERSONAL A 
INNER JOIN LOCAL L ON A.LOCAL = L.LOC_ID
INNER JOIN GRUPOS G ON A.IdGrupo = G.IdGrupo
WHERE A.PER_COD = '72130767'


INSERT INTO ASISTENCIA_TEMP (COD_ASI_TEM, HORA_ENT, HORA_SAL, HORA_ENT_REF, HORA_SAL_REF, COMENTARIO, HORAS_REF, HORAS, FECHA, EST_REF, EST_ASIS, EMP_COD, PER_COD, LOC_COD,  
HoraIngresoEmp, HoraSalidaEmp, Tolerancia, SEG_INGRESO, SEG_SALIDA, SEG_TOLERANCIA, Crtd_DateTime, LUpd_DateTime, HORA_ORIG_ENT, HORA_ORIG_SAL, OBS_PE, MARC_ESP)

VALUES ('OFI000000000001',GETDATE(),GETDATE(),GETDATE(),GETDATE(),    
'FALTO',0,0,(CONVERT(CHAR(10), GETDATE(), 120)),'N','F','20394862704',(case when len('72130767')<8 then RIGHT('00000000' + Ltrim(Rtrim('72130767')),8) else '72130767' end),  
1, '07:30:00', '16:45:00', '00:10:00', '27000', '60300', '600', GETDATE(), GETDATE(), GETDATE(), GETDATE(), '', 0)

-- TRUNCATE TABLE ASISTENCIA_TEMP

--VALUES (@NUEVOID,GETDATE(),GETDATE(),GETDATE(),GETDATE(),    
--@COMENTARIO,0,0,(CONVERT(CHAR(10), GETDATE(), 120)),'N','I',@EMP_COD,(case when len(@PER_COD)<8 then RIGHT('00000000' + Ltrim(Rtrim(@PER_COD)),8) else @PER_COD end),  
--@LOC_COD, @HoraIngEmp, @HoraSalEmp, @MIN_INGRESO,GETDATE(), 'SUPERADMIN',GETDATE(), 'SUPERADMIN', GETDATE(), GETDATE(), '', 0)



-- joseph
INSERT INTO ASISTENCIA_TEMP (COD_ASI_TEM, HORA_ENT, HORA_SAL, HORA_ENT_REF, HORA_SAL_REF, COMENTARIO, HORAS_REF, HORAS, FECHA, EST_REF, EST_ASIS, EMP_COD, PER_COD, LOC_COD,  
HoraIngresoEmp, HoraSalidaEmp, Tolerancia, SEG_INGRESO, SEG_SALIDA, SEG_TOLERANCIA, Crtd_DateTime, LUpd_DateTime, HORA_ORIG_ENT, HORA_ORIG_SAL, OBS_PE, MARC_ESP)

VALUES ('OFI000000000003',GETDATE(),GETDATE(),GETDATE(),GETDATE(),    
'FALTO',0,0,(CONVERT(CHAR(10), GETDATE(), 120)),'N','F','20394862704',(case when len('72130767')<8 then RIGHT('00000000' + Ltrim(Rtrim('72130767')),8) else '72130767' end),  
1, '07:30:00', '16:45:00', '00:10:00', '27000', '60300', '600', GETDATE(), GETDATE(), GETDATE(), GETDATE(), '', 0)


--joel
INSERT INTO ASISTENCIA_TEMP (COD_ASI_TEM, HORA_ENT, HORA_SAL, HORA_ENT_REF, HORA_SAL_REF, COMENTARIO, HORAS_REF, HORAS, FECHA, EST_REF, EST_ASIS, EMP_COD, PER_COD, LOC_COD,  
HoraIngresoEmp, HoraSalidaEmp, Tolerancia, SEG_INGRESO, SEG_SALIDA, SEG_TOLERANCIA, Crtd_DateTime, LUpd_DateTime, HORA_ORIG_ENT, HORA_ORIG_SAL, OBS_PE, MARC_ESP)

VALUES ('OFI000000000002',GETDATE(),GETDATE(),GETDATE(),GETDATE(),    
'FALTO',0,0,(CONVERT(CHAR(10), GETDATE(), 120)),'N','F','20394862704',(case when len('77683117')<8 then RIGHT('00000000' + Ltrim(Rtrim('77683117')),8) else '77683117' end),  
1, '07:30:00', '16:45:00', '00:10:00', '27000', '60300', '600', GETDATE(), GETDATE(), GETDATE(), GETDATE(), '', 0)


--kevin
INSERT INTO ASISTENCIA_TEMP (COD_ASI_TEM, HORA_ENT, HORA_SAL, HORA_ENT_REF, HORA_SAL_REF, COMENTARIO, HORAS_REF, HORAS, FECHA, EST_REF, EST_ASIS, EMP_COD, PER_COD, LOC_COD,  
HoraIngresoEmp, HoraSalidaEmp, Tolerancia, SEG_INGRESO, SEG_SALIDA, SEG_TOLERANCIA, Crtd_DateTime, LUpd_DateTime, HORA_ORIG_ENT, HORA_ORIG_SAL, OBS_PE, MARC_ESP)

VALUES ('OFI000000000001',GETDATE(),GETDATE(),GETDATE(),GETDATE(),    
'FALTO',0,0,(CONVERT(CHAR(10), GETDATE(), 120)),'N','F','20394862704',(case when len('70687806')<8 then RIGHT('00000000' + Ltrim(Rtrim('70687806')),8) else '70687806' end),  
1, '07:30:00', '16:45:00', '00:10:00', '27000', '60300', '600', GETDATE(), GETDATE(), GETDATE(), GETDATE(), '', 0)

--kevin
INSERT INTO ASISTENCIA_TEMP (COD_ASI_TEM, HORA_ENT, HORA_SAL, HORA_ENT_REF, HORA_SAL_REF, COMENTARIO, HORAS_REF, HORAS, FECHA, EST_REF, EST_ASIS, EMP_COD, PER_COD, LOC_COD,  
HoraIngresoEmp, HoraSalidaEmp, Tolerancia, SEG_INGRESO, SEG_SALIDA, SEG_TOLERANCIA, Crtd_DateTime, LUpd_DateTime, HORA_ORIG_ENT, HORA_ORIG_SAL, OBS_PE, MARC_ESP)

VALUES ('OFI000000000004',GETDATE(),GETDATE(),GETDATE(),GETDATE(),    
'FALTO',0,0,(CONVERT(CHAR(10), GETDATE(), 120)),'N','F','20394862704',(case when len('70194839')<8 then RIGHT('00000000' + Ltrim(Rtrim('70194839')),8) else '70194839' end),  
1, '07:30:00', '16:45:00', '00:10:00', '27000', '60300', '600', GETDATE(), GETDATE(), GETDATE(), GETDATE(), '', 0)
