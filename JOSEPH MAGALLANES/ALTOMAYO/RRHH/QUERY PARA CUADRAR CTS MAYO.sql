
--select * from pactsH where PeriodoId = '202105'

select a.MesesComputable, b.monto, * 
-- update a set a.MesesComputable = b.monto
from pactsd a
inner join datosa b on a.PeriodoId = b.periodo and a.PerId = b.dni
where PeriodoId = '202105'
and a.MesesComputable <> b.monto

update pactsd set RemComputable = Basico + AsigFamiliar + PromComision + PromHorasExtras + SextoGrati where PeriodoId = '202105'
update pactsd set CTSMeses = (RemComputable / 12) * MesesComputable where PeriodoId = '202105'
update pactsd set CTSDias = ((RemComputable / 12) / 30) * DiasComputable where PeriodoId = '202105'

update pactsd set CTSTotal = CTSMeses + CTSDias, CTSProvisionar = CTSMeses + CTSDias where PeriodoId = '202105'

select b.perbancocts, a.EntFId, c.descr, a.NroCuenta, b.user2, a.* 
-- update a set a.EntFId = b.perbancocts
-- update a set a.EntFNombre = c.descr
-- update a set a.NroCuenta = b.user2
from pactsd a
inner join personal b on a.PerId = b.perid
left join PAENTF c on b.perbancocts = c.EntFid
where PeriodoId = '202105'


select * from PACtsD where PeriodoId = '202105'

select * from pactsd where PeriodoId = '202011' and PerId = '72130767'
select * from pactsd where PeriodoId = '202011' and Vacacion <> 0
select * from pactsd where PeriodoId = '202011' and PerId = '09855011'

-- truncate table datosa
--select * from datosa
create table datosa
(
dni varchar(15),
monto float,
periodo varchar(6)
)

insert into datosa (dni, monto, periodo)
values
('40640940',6,'202105'),
('46996279',5,'202105'),
('16799734',6,'202105'),
('23950724',6,'202105'),
('44528534',6,'202105'),
('47925909',5,'202105'),
('41780751',6,'202105'),
('42347030',6,'202105'),
('48565398',6,'202105'),
('70668990',5,'202105'),
('40045308',5,'202105'),
('05640925',6,'202105'),
('41328342',6,'202105'),
('41466697',1,'202105'),
('76577834',4,'202105'),
('16484989',6,'202105'),
('47713878',5,'202105'),
('45785848',5,'202105'),
('00327816',6,'202105'),
('43582949',6,'202105'),
('71413200',5,'202105'),
('43275426',6,'202105'),
('41766842',6,'202105'),
('43223062',1,'202105'),
('47645401',6,'202105'),
('70687806',6,'202105'),
('43204894',6,'202105'),
('46803002',6,'202105'),
('42242444',6,'202105'),
('48684773',6,'202105'),
('47451154',6,'202105'),
('72932533',2,'202105'),
('44466241',6,'202105'),
('71469061',6,'202105'),
('10774615',6,'202105'),
('46310478',6,'202105'),
('48181244',6,'202105'),
('43201907',2,'202105'),
('46217224',5,'202105'),
('70167110',5,'202105'),
('41602381',6,'202105'),
('71579559',6,'202105'),
('40270799',5,'202105'),
('27719509',6,'202105'),
('42486317',6,'202105'),
('76086519',5,'202105'),
('75952360',2,'202105'),
('48409634',2,'202105'),
('46544714',6,'202105'),
('47429853',6,'202105'),
('73625819',6,'202105'),
('47832235',6,'202105'),
('73738675',5,'202105'),
('41885922',3,'202105'),
('20077851',6,'202105'),
('45244880',6,'202105'),
('73907997',2,'202105'),
('29733658',6,'202105'),
('45483604',5,'202105'),
('42517608',6,'202105'),
('44544359',5,'202105'),
('40953005',6,'202105'),
('43063736',6,'202105'),
('41436929',6,'202105'),
('03700478',6,'202105'),
('47780044',5,'202105'),
('46101180',6,'202105'),
('10142103',6,'202105'),
('03385891',6,'202105'),
('41455092',5,'202105'),
('72306148',6,'202105'),
('10659294',6,'202105'),
('42182381',6,'202105'),
('40788492',6,'202105'),
('74690246',1,'202105'),
('70600159',6,'202105'),
('45123196',6,'202105'),
('18066492',6,'202105'),
('45904187',6,'202105'),
('41929511',6,'202105'),
('43711111',6,'202105'),
('42073237',6,'202105'),
('45243562',6,'202105'),
('41858770',6,'202105'),
('16542308',6,'202105'),
('48167756',6,'202105'),
('42622439',6,'202105'),
('45513673',5,'202105'),
('46436988',6,'202105'),
('47278413',6,'202105'),
('47610158',6,'202105'),
('70856238',6,'202105'),
('25609105',6,'202105'),
('41164905',6,'202105'),
('41184520',6,'202105'),
('73535903',5,'202105'),
('77436430',6,'202105'),
('70231098',6,'202105'),
('75357206',5,'202105'),
('72774488',5,'202105'),
('45590321',6,'202105'),
('41414810',5,'202105'),
('10025100',6,'202105'),
('46311131',5,'202105'),
('44665939',6,'202105'),
('19936035',6,'202105'),
('47067463',1,'202105'),
('45732584',5,'202105'),
('46774687',5,'202105'),
('16678477',6,'202105'),
('72174833',2,'202105'),
('80476920',6,'202105'),
('16410842',6,'202105'),
('43189942',6,'202105'),
('41532023',6,'202105'),
('41341431',6,'202105'),
('46741744',6,'202105'),
('41400394',6,'202105'),
('40572017',4,'202105'),
('44378426',3,'202105'),
('44646062',6,'202105'),
('72496945',6,'202105'),
('20108971',6,'202105'),
('73747727',5,'202105'),
('74031374',6,'202105'),
('44192854',5,'202105'),
('43485911',6,'202105'),
('72130767',6,'202105'),
('46379295',6,'202105'),
('45709155',6,'202105'),
('47388894',6,'202105'),
('41966996',6,'202105'),
('70887256',2,'202105'),
('43068653',5,'202105'),
('43486314',6,'202105'),
('77820619',5,'202105'),
('43165434',6,'202105'),
('47646124',5,'202105'),
('45511024',6,'202105'),
('41560666',6,'202105'),
('42486455',6,'202105'),
('41030258',6,'202105'),
('08178597',6,'202105'),
('45203105',6,'202105'),
('00796675',1,'202105'),
('45239995',6,'202105'),
('42832629',6,'202105'),
('41838904',5,'202105'),
('41587951',2,'202105'),
('16719966',6,'202105'),
('44195967',6,'202105'),
('73766006',5,'202105'),
('001251391',6,'202105'),
('41966392',6,'202105'),
('42888264',6,'202105'),
('09546766',6,'202105'),
('48237465',6,'202105'),
('41639317',6,'202105'),
('42855968',6,'202105'),
('76571800',5,'202105'),
('73052908',5,'202105'),
('41361174',6,'202105'),
('43064252',6,'202105'),
('71543093',3,'202105'),
('47856114',5,'202105'),
('41695428',6,'202105'),
('16640841',5,'202105'),
('41183856',5,'202105'),
('48490381',6,'202105'),
('09855011',6,'202105'),
('44429816',6,'202105'),
('43721240',6,'202105'),
('17521042',6,'202105'),
('73036851',5,'202105'),
('48030329',5,'202105'),
('42780335',6,'202105'),
('75994554',2,'202105'),
('41210009',6,'202105'),
('44291021',3,'202105'),
('16678906',6,'202105'),
('09497086',6,'202105'),
('43608369',5,'202105'),
('47787124',2,'202105'),
('42614783',6,'202105'),
('70777866',6,'202105'),
('75804731',1,'202105'),
('43677878',2,'202105'),
('45695751',5,'202105'),
('41661577',6,'202105'),
('45494339',6,'202105'),
('45355889',6,'202105'),
('32922050',6,'202105'),
('08735967',6,'202105'),
('41225399',6,'202105'),
('47898249',5,'202105'),
('46056625',6,'202105'),
('42791427',6,'202105'),
('43534283',6,'202105'),
('74313601',5,'202105'),
('46653628',6,'202105'),
('16684057',6,'202105'),
('29635247',6,'202105'),
('44588986',6,'202105'),
('46081608',6,'202105'),
('46786830',1,'202105'),
('72741573',5,'202105'),
('41636118',6,'202105'),
('45503264',6,'202105'),
('43113279',6,'202105'),
('47930481',6,'202105'),
('45554296',5,'202105'),
('15648717',5,'202105'),
('44891191',6,'202105'),
('40881502',3,'202105'),
('41265754',1,'202105'),
('70069937',3,'202105'),
('46409438',5,'202105'),
('46250309',6,'202105'),
('76001361',5,'202105'),
('77282289',2,'202105'),
('46338697',6,'202105'),
('70194839',6,'202105'),
('62476264',5,'202105'),
('72757914',5,'202105'),
('46203303',6,'202105'),
('40053619',6,'202105'),
('40424961',6,'202105'),
('48062818',6,'202105'),
('44930457',1,'202105'),
('45871496',6,'202105'),
('44338499',6,'202105'),
('45294800',6,'202105'),
('22422595',6,'202105'),
('47804145',6,'202105'),
('10287282',6,'202105'),
('73871997',5,'202105'),
('76385676',5,'202105'),
('72948756',6,'202105'),
('41278602',6,'202105'),
('42596464',6,'202105'),
('10509942',6,'202105'),
('45206375',5,'202105'),
('44338847',6,'202105'),
('40783587',6,'202105'),
('10338685',6,'202105'),
('42150338',6,'202105'),
('41278218',6,'202105'),
('41378071',6,'202105'),
('48347572',6,'202105'),
('09888735',6,'202105'),
('10644596',6,'202105'),
('07258243',5,'202105'),
('29638655',6,'202105'),
('47770848',6,'202105'),
('47991087',6,'202105'),
('47583861',6,'202105'),
('77683117',6,'202105'),
('48319179',6,'202105'),
('71709963',6,'202105'),
('76555609',6,'202105'),
('25707582',5,'202105'),
('70006231',5,'202105'),
('26723736',6,'202105'),
('41185947',6,'202105'),
('41818102',5,'202105'),
('47209752',6,'202105'),
('44481609',6,'202105'),
('45478071',6,'202105'),
('16704793',6,'202105')